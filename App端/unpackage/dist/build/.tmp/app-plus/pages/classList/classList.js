(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/classList/classList"],{1671:function(t,e,s){"use strict";s.r(e);var a=s("a728"),n=s("4309");for(var i in n)"default"!==i&&function(t){s.d(e,t,function(){return n[t]})}(i);s("a4d1");var o=s("2877"),l=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=l.exports},4309:function(t,e,s){"use strict";s.r(e);var a=s("d710"),n=s.n(a);for(var i in a)"default"!==i&&function(t){s.d(e,t,function(){return a[t]})}(i);e["default"]=n.a},8874:function(t,e,s){},a4d1:function(t,e,s){"use strict";var a=s("8874"),n=s.n(a);n.a},a728:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},n=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return n})},d710:function(t,e,s){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=c(s("a34a")),o=c(s("73db")),l=c(s("ea68")),r=c(s("0ad2"));function c(t){return t&&t.__esModule?t:{default:t}}function u(t,e,s,a,n,i,o){try{var l=t[i](o),r=l.value}catch(c){return void s(c)}l.done?e(r):Promise.resolve(r).then(a,n)}function d(t){return function(){var e=this,s=arguments;return new Promise(function(a,n){var i=t.apply(e,s);function o(t){u(i,a,n,o,l,"next",t)}function l(t){u(i,a,n,o,l,"throw",t)}o(void 0)})}}var h=function(){return s.e("components/class-list").then(s.bind(null,"a0c8"))},f=function(){return s.e("components/swiper-tab").then(s.bind(null,"331b"))},p=function(){return Promise.all([s.e("common/vendor"),s.e("components/uni-fab/uni-fab")]).then(s.bind(null,"0b48"))},m=function(){return s.e("components/no-thing").then(s.bind(null,"ba61"))},g={components:{uniFab:p,classList:h,swiperTab:f,noThing:m},data:function(){return{tabIndex:0,tabBars:[{name:"已创建",id:"create"},{name:"已加入",id:"join"}],swiperHeight:0,leftColor:["#9152fa","#2692ff","#fc7c1c","#0cd452","#fc424b"],classList:[{list:[]},{list:[]}],horizontal:"right",vertical:"bottom",direction:"horizontal",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#9152fa",buttonColor:"#9152fa"},floatButton:"inline",flag:0,lastX:0,lastY:0,classModalShow:null,inputName:"",inputPeoNum:"",postClassId:"",poster:{},qrShow:!1,canvasId:"ShareCanvasId"}},onLoad:function(e){var s=this;n=this;var a=this.checkLogin("../classList/classList",1);a&&("undefined"!=typeof e.tabIndex?this.tabIndex=e.tabIndex:this.tabIndex=0,this.getInfo(this.tabIndex),t.removeStorageSync("tmpIndex"),t.getSystemInfo({success:function(e){var a=e.windowHeight-s.CustomBar-t.upx2px(105);s.swiperHeight=a}}))},methods:{tabtap:function(t){this.tabIndex=t},tabChange:function(e){var s=this;this.tabIndex=e.detail.current,t.showLoading({title:"获取数据..."}),setTimeout(function(){s.classList[s.tabIndex].list=[],s.getInfo(s.tabIndex),t.hideLoading()},500)},getInfo:function(){var e=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=t.getStorageSync("USERID");t.request({url:n.apiServer+"create&m=classList",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:a,tabIndex:s},success:function(t){if(t=t.data,"undefined"!=typeof t.data&&null!=t.data)for(var s=0;s<t.data.length;s++){var a=t.data[s];"undefined"==typeof JSON.parse(t.data[s].classInfo).userList?a["realPeoNum"]=0:a["realPeoNum"]=JSON.parse(t.data[s].classInfo).userList.length;var n=s%e.leftColor.length;a["leftColor"]=e.leftColor[n],e.classList[e.tabIndex].list.push(a)}else e.classList[e.tabIndex].list=[]}})},classModal:function(t){this.classModalShow="editClass",this.inputName=this.classList[this.tabIndex].list[t].classname,this.inputPeoNum=this.classList[this.tabIndex].list[t].peonum,this.postClassId=this.classList[this.tabIndex].list[t].classid},classHide:function(t){this.classModalShow=null},toCreate:function(e){t.navigateTo({url:"../createClass/createClass",success:function(t){},fail:function(){},complete:function(){}})},formEditClass:function(e){var s=this,a=this.postClassId,i=e.detail.value.newName,o=e.detail.value.newNum;t.request({url:n.apiServer+"create&m=editClass",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{classId:a,newName:i,newNum:o},success:function(e){e=e.data,"ok"==e.status?(t.showToast({title:e.data,icon:"none"}),s.classList[s.tabIndex].list=[],s.getInfo()):"error"==e.status&&t.showToast({title:e.data,icon:"none"})}})},goPeoList:function(e){t.navigateTo({url:"../classPeopleList/classPeopleList?classId="+e+"&tabIndex="+this.tabIndex})},delClass:function(e){var s=this;t.showModal({title:"温馨提示",content:"确定删除该班级吗？",success:function(a){a.confirm&&t.request({url:n.apiServer+"create&m=delClass",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{classId:e},success:function(e){e=e.data,"ok"==e.status?(t.showToast({title:e.data,icon:"none"}),s.classList[s.tabIndex].list=[],s.getInfo(s.tabIndex)):"error"==e.status&&t.showToast({title:e.data,icon:"none"})}})}})},outClass:function(e){var s=this,a=t.getStorageSync("USERID");t.showModal({title:"温馨提示",content:"确定退出该班级吗？",success:function(i){i.confirm&&t.request({url:n.apiServer+"create&m=outClass",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{classId:e,userId:a},success:function(e){e=e.data,"ok"==e.status?(t.showToast({title:e.data,icon:"none"}),s.classList[s.tabIndex].list=[],s.getInfo(s.tabIndex)):"error"==e.status&&t.showToast({title:e.data,icon:"none"})}})}})},shareFc:function(){var e=d(i.default.mark(function e(s){var n,c,u=this;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.getStorageSync("tmpIndex")!==s){e.next=4;break}this.qrShow=!0,e.next=21;break;case 4:return e.prev=4,t.setStorageSync("tmpIndex",s),n=encodeURIComponent(JSON.stringify({uid:this.classList[this.tabIndex].list[s].userid,cid:this.classList[this.tabIndex].list[s].classid})),e.next=9,(0,l.default)({type:"testShareType",posterCanvasId:this.canvasId,qrCodeArray:function(t,e){return[{text:r.default.enCode(n),size:580,dx:(t.width-580)/2,dy:t.height-1200}]},imagesArray:function(t,e){return[{url:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1314428097,3858988978&fm=26&gp=0.jpg",dx:100,dy:t.height-300,circleSet:{circle:!0},infoCallBack:function(t){var e=200/t.height;return{dWidth:t.width*e,dHeight:200}}}]},setCanvasWH:function(t,e){u.poster=t},setDraw:function(e){var a=e.Context,n=e.bgObj;e.type;a.setFillStyle("black"),a.setGlobalAlpha(.3),a.fillRect(0,n.height-400,n.width,400),a.setGlobalAlpha(1),a.setFillStyle("white"),a.setFontSize(100);var i=t.getStorageSync("realName");a.fillText(i,n.width-50*i.length-160,n.height-175),a.setFillStyle("orange"),a.setFontSize(110);var o=u.classList[u.tabIndex].list[s].classname;a.fillText(o,(n.width-110*o.length)/2,n.height-430)}});case 9:c=e.sent,console.log(a("海报生成成功， 临时路径: "+c.poster.tempFilePath," at pages\\classList\\classList.vue:379")),this.poster.finalPath=c.poster.tempFilePath,console.log(a(this.poster.finalPath," at pages\\classList\\classList.vue:381")),this.qrShow=!0,e.next=21;break;case 16:e.prev=16,e.t0=e["catch"](4),o.default.hideLoading(),o.default.showToast(JSON.stringify(e.t0)),console.log(a(JSON.stringify(e.t0)," at pages\\classList\\classList.vue:386"));case 21:case"end":return e.stop()}},e,this,[[4,16]])}));function s(t){return e.apply(this,arguments)}return s}(),saveImage:function(){t.saveImageToPhotosAlbum({filePath:this.poster.finalPath,success:function(t){o.default.showToast("保存成功")}})},share:function(){o.default.getShare(!1,!1,2,"","","",this.poster.finalPath,!1,!1)},hideQr:function(){this.qrShow=!1}}};e.default=g}).call(this,s("6e42")["default"],s("0de9")["default"])}},[["f517","common/runtime","common/vendor"]]]);