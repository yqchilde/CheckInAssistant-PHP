(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/signIn/signIn"],{"5faf":function(e,t,i){},"67b2":function(e,t,i){"use strict";(function(e){var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{selectRoom:[],roomIndex:0,room_name:[],room_id:[],roomShow:!1,selectTime:[{timeId:"1min",timeName:"1分钟"},{timeId:"2min",timeName:"2分钟"},{timeId:"3min",timeName:"3分钟"},{timeId:"4min",timeName:"4分钟"},{timeId:"5min",timeName:"5分钟"}],timeIndex:0,time_name:[],time_id:[],timeShow:!1,signInWay:"",radio:"code",norRadio:!1,dizhi:"",latitude:0,longitude:0,covers:[{latitude:0,longitude:0,iconPath:"./static/images/inc/location.png"}]}},onLoad:function(){var t=this;i=this;var n=this.checkLogin("../roomList/roomList",1);n&&(this.getRoom(),this.selectTime.forEach(function(e){t.time_name.push(e.timeName),t.time_id.push(e.timeId)}),e.setNavigationBarTitle({title:"创建签到"}))},methods:{bindSelectRoom:function(e){i.roomShow=!0,i.roomIndex=e.detail.value},bindSelectTime:function(e){i.timeShow=!0,i.timeIndex=e.detail.value},getRoom:function(t){var o=this;n=e.getStorageSync("USERID"),e.request({url:i.apiServer+"create&m=getRoom",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:n},success:function(e){if(e=e.data,"ok"==e.status){var t=JSON.parse(e.data);o.selectRoom=t}o.selectRoom.forEach(function(e){o.room_name.push(e.roomName),o.room_id.push(e.roomId)})}})},RadioChange:function(t){var n=this;this.signInWay=t.detail.value,this.norRadio=!0,"gps"==t.detail.value&&e.getLocation({type:"gcj02",success:function(e){n.latitude=e.latitude,n.longitude=e.longitude,n.covers[0].latitude=e.latitude,n.covers[0].longitude=e.longitude;var t=new plus.maps.Point(n.longitude,n.latitude);plus.maps.Map.reverseGeocode(t,{},function(e){var t=e.address;e.coord,e.coordType;i.dizhi=t})}})},formSubmit:function(t){var n=e.getStorageSync("USERID"),o=this.room_id[t.detail.value.selectorRoom],a=this.time_id[t.detail.value.selectorTime],s=this.signInWay;if("undefined"==typeof o)return e.showToast({title:"请选择课堂",duration:1500,icon:"none"}),!1;if("undefined"==typeof a)return e.showToast({title:"请选择时间",duration:1500,icon:"none"}),!1;if(1==this.norRadio&&0==s.length)return e.showToast({title:"请选择签到方式",duration:1500,icon:"none"}),!1;switch(0==this.norRadio&&(s="code"),s){case"code":var r=this.getRand();e.request({url:i.apiServer+"sign&m=signInByCode",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:n,roomId:o,signTime:a,signInWay:s,signCode:r},success:function(t){t=t.data,"ok"==t.status?(e.showToast({title:"发起签到成功",image:"/static/images/inc/icon_success.png",icon:"none"}),setTimeout(function(i){e.navigateTo({url:"../signer/signer?signId="+t.data+"&openMode=create"})},500)):"error"==t.status&&e.showToast({title:t.data,image:"/static/images/inc/icon_warning.png",icon:"none"})}});break;case"gps":var d=this.latitude,c=this.longitude;e.request({url:i.apiServer+"sign&m=signInByGps",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:n,roomId:o,signTime:a,signInWay:s,latitude:d,longitude:c},success:function(t){t=t.data,"ok"==t.status?(e.showToast({title:"发起签到成功",image:"/static/images/inc/icon_success.png",icon:"none"}),setTimeout(function(i){e.navigateTo({url:"../signer/signer?signId="+t.data+"&openMode=create"})},500)):"error"==t.status&&e.showToast({title:t.data,image:"/static/images/inc/icon_warning.png",icon:"none"})}});break;default:break}},getRand:function(){for(var e=new Array,t=4,i=new Array(0,1,2,3,4,5,6,7,8,9),n=0;n<t;n++){var o=Math.floor(10*Math.random());e+=i[o]}return e.length!=t&&this.getRandomCode(),e}}};t.default=o}).call(this,i("6e42")["default"])},9306:function(e,t,i){"use strict";i.r(t);var n=i("b120"),o=i("dec5");for(var a in o)"default"!==a&&function(e){i.d(t,e,function(){return o[e]})}(a);i("d214");var s=i("2877"),r=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);t["default"]=r.exports},b120:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},o=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o})},d214:function(e,t,i){"use strict";var n=i("5faf"),o=i.n(n);o.a},dec5:function(e,t,i){"use strict";i.r(t);var n=i("67b2"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,function(){return n[e]})}(a);t["default"]=o.a}},[["65c6","common/runtime","common/vendor"]]]);